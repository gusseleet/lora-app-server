language: go
sudo: required
dist: trusty
go:
- 1.9.x
services:
- redis-server
- postgresql
- docker
addons:
  postgresql: '9.5'
before_install:
- pip install --user awscli
- export PATH=$PATH:$HOME/.local/bin
install:
- echo "install nothing!"
script:
- eval $(aws ecr get-login --no-include-email --region eu-central-1)
- docker build -t maliot .
- docker tag maliot:latest 228684700718.dkr.ecr.eu-central-1.amazonaws.com/maliot:latest
- docker push 228684700718.dkr.ecr.eu-central-1.amazonaws.com/maliot:latest
deploy:
  provider: s3
  access_key_id: AKIAJL2ERUB644Z3MALA
  secret_access_key:
    secure: Ofgvp0lFlCPEhxgk0j9S9T2a2Gqaa/YXSYSIsHivI8J+QbhQhq4j2i6J8nmBaYaJaIFLptQLYK23WQQrJMa24G11xbwE/Z8l5BrFSlGI0u3ginE1uQ9ghfzc3bijr1X4wdW8OGqjDW1qNlmHr8l056Ms8WUkhPK6P7ZW7Br8rB+ZGG1xzb2YlgpkC/coldjFk4NCNuqZqu99Bv4LD/WkGydrExhHhDNFGZ/NN1s//axaWhIsjGVOxBenSCi1KeI2Lrtb4XzAHn02NkuMgNompgOzRGxYCEQK9NLHdkfB7eHxGGoaU2/TIFQSQQIO6kt/D7QGJHx7+uDbYC02jFSogFd9rt+rHD/O8vP3tYaWmzhd83jnZc3edrrFRamTcG5ByfmzrhK5orMUn1rBwH4M1Tzku+8q9ds6EfnmwEbyyP2svu1dikYLffth2wvoJXpr4iNk9csKl52q1Ndq5KJ4A41PK7+0rf6bR14QgCjQRoN4zZsY0cwqj21blCGdSOYN0FGxmeSvVOmNgqsoB5Y6cAFbcH6ytGsATwZz3hqroylsVQAmIPy+1hcPKOSB5d5V3v2WXJFCHAVcQSqg6UuQoTTyWaGYkARScYXYpsylFXeC5b0qvfXLxa2i+sJU2vQeMJnhq6aVEPuFjjLMZ4xALmghLQGl5mO7tUZpmcVHTQc=
  bucket: elasticbeanstalk-eu-central-1-228684700718
  acl: private
  on:
    repo: gusseleet/lora-app-server
    branch: post_user
after_success:
- pip install --user awscli
- export PATH=$PATH:/$HOME/.local/bin
- aws ecr create-repository --repository-name $REPO --region us-west-2
- eval $(aws ecr get-login --region us-west-2)
- docker tag $REPO:$TRAVIS_BUILD_NUMBER $AWS_ACCOUNT_NUMBER.dkr.ecr.us-west-2.amazonaws.com/$REPO:$TRAVIS_BUILD_NUMBER
- docker push $AWS_ACCOUNT_NUMBER.dkr.ecr.us-west-2.amazonaws.com/$REPO:$TRAVIS_BUILD_NUMBER
env:
  global:
  - secure: CgwrPYCBikhTVHSPa42zX6YUJmI344Q1w12jtzgwG/GzLxPptQ0O8DcWa236SrhYPBIc2E1Dk10Dv8aV1y6PhRo7JnPneZ+FpLk+Nf0hN1LWk1MySUjZCIxFNuTaon2b3Wj2+op8MPmlGw2HYLGTNuZkanXq4ArycWIcxc/L239dSCYEgzNPm2ujUh6riHA9zx+Qd2ZD+KR/PBCmr1aU3e5gs8ktyuIvtsjrgFtXSl9R8Sv7gOO6U0/1UpT7N8rQBuUrGmuC4qOjEVpV7Xj6TyoMv6l8nm/JrULp9irNRXuG2Y6TGMQA31Otvxe2prqaRcApKFwA1/JpPxK+U29rt5JwXIcrxdYbR61WgTgzJLjqnc8uov/nTobPXMFhVH0vQjeNDTTue3FLKzSh93unwsklFeUVsJe77APJ7aLmHptxlicSjwQPAQehpdJRReXhxcLfPlnUFVBqr/yUGhIPu1btuHdSllOULVVdeqJ0YFwebCYRjUzsZUOxfPhPnFajUMPVuYqykyODDVki/DW6KVPQkw4NXVVFsP++gYHlMHXrqJBN7kEo3KjXJmECcq8bzjirhAjXvMONEPMIzTaORb2PWfL3XbkLxDEA0ynJDukYaqazUquW/hJF0uCt+OYvUukoYH3ra+CmsvcP8BYsrAWWBkc7heJ1xxGwa0Zny1o=
  - secure: P/dpTw2KO7GJlAFyuE2vMsUU/n4u++/pRFnlhPuUiNZ0KBddrfH/5LxLYe1Om4kXoigutL/vTR7rq379Nw9rlI4dDO60tlvRrjSCdeKdgkpEnLWu9FOVRvU4p613g10P+n+o0vEHbwF4wcKvpb8vQSZ7zgYI/bnQqoq6FNL2x5opYr8DiV9M9MA8TyhqSYJ0ZoMkr/TmQoHODmVKuCTCwBhF4doBZgEKjG6enmGzhDo4E/cV72Ul79WQvtL2L8cK/2BJaDSHQkNzWwyGgUATG4gX8JKvydTFbR1il7pbfFIfHwu6vHJx3254mVb53q7hAm988fsu2uzakIEBL8+NS8HheVBCpLnccFF9Ps/3RERMushLoSQJrePzvl0Qu4XsFMLp6CBSdPFbu+AZNGXvNQOznSXVNaswvOsi5If94Dj6GmwqImEThXh7hr6UEGTnBKm5JySx2NW02mhCtsLuADUm8nyMQ+TOVCA9iB+DeSqcLPeGHcGNho93lnCA7Iu8QbYMhk7qbxn5u7LXyAIJSLP6pJspCs3PhcGSXGBMduucdejU+L3NMr51GqRhw+VBTbOs1GqlAKVZ3fRRNszUuxvimqntYfqjNepD1wTHCyZW1rsnI24B4puusVZwpachWgGCexL4D+dzdefA0coygjjc2ccrQ+1YlYK0c7bYGdE=
