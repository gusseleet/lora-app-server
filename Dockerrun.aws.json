{
  "AWSEBDockerrunVersion": 2,
  "volumes": [
    {
      "name": "appserver",
      "host": {
        "sourcePath": "current-appserver"
      }
    },
    {
      "name": "db",
      "host": {
        "sourcePath": "/home/ec2-user/db"
      }
    },
    {
      "name": "db_ns",
      "host": {
        "sourcePath": "/home/ec2-user/db_ns"
      }
    },
    {
      "name": "redis",
      "host": {
        "sourcePath": "current-redis"
      }
    },
    {
      "name": "mosquitto",
      "host": {
        "sourcePath": "current-mosquitto"
      }
    },
    {
      "name": "client-ui",
      "host": {
        "sourcePath": "/home/ec2-user/client"
      }
    }
  ],
  "containerDefinitions": [

    {
      "name": "appserver",
      "image": "228684700718.dkr.ecr.eu-central-1.amazonaws.com/maliot:latest",
      "essential": true,
      "memory": 256,
      "mountPoints": [
        {
          "sourceVolume": "client-ui",
          "containerPath": "/go/src/github.com/gusseleet/lora-app-server/client-test"
        }
      ],
      "links": [
      ],
      "environment": [
        {
          "name": "POSTGRES_DSN",
          "value": "postgres://loraserver:loraserver@postgres/loraserver?sslmode=disable"
        },
        {
          "name": "REDIS_URL",
          "value": "redis://redis:6379"
        },
        {
          "name": "MQTT_SERVER",
          "value": "tcp://mosquitto:1883"
        },
        {
          "name": "TEST_POSTGRES_DSN",
          "value": "postgres://loraserver:loraserver@postgres/loraserver?sslmode=disable"
        },
        {
          "name": "TEST_REDIS_URL",
          "value": "redis://redis:6379"
        },
        {
          "name": "TEST_MQTT_SERVER",
          "value": "tcp://mosquitto:1883"
        },
        {
          "name": "JWT_SECRET",
          "value": "verysecret"
        },
        {
          "name": "HTTP_TLS_CERT",
          "value": "/etc/lora-app-server/certs/http.pem"
        },
        {
          "name": "HTTP_TLS_KEY",
          "value": "/etc/lora-app-server/certs/http-key.pem"
        },
        {
          "name": "AS_PUBLIC_SERVER",
          "value": "appserver:8001"
        },
        {
          "name": "DB_AUTOMIGRATE",
          "value": "true"
        }
      ],
      "command": [
        "make",
        "serve"
      ],
      "portMappings": [
        {
          "hostPort": 8080,
          "containerPort": 8080
        }
      ]
    },

    {
      "name": "postgres",
      "image": "postgres:9.5",
      "essential": true,
      "memory": 512,
      "environment": [
        {
          "name": "POSTGRES_PASSWORD",
          "value": "loraserver"
        },
        {
          "name": "POSTGRES_USER",
          "value": "loraserver"
        },
        {
          "name": "POSTGRES_DB",
          "value": "loraserver"
        }
      ],
      "command": [],
      "portMappings": [],
      "mountPoints": [
        {
          "sourceVolume": "db",
          "containerPath": "/var/lib/postgresql/data"
        }
      ]
    }

  ]
}